import { Injectable, Inject } from '@angular/core';
import { filter, map } from 'rxjs/operators';
import { STRIPE_PUBLISHABLE_KEY, STRIPE_OPTIONS, NGX_STRIPE_VERSION } from '../interfaces/ngx-stripe.interface';
import { StripeInstance } from './stripe-instance.class';
import * as i0 from "@angular/core";
import * as i1 from "./api-loader.service";
import * as i2 from "./window-ref.service";
export class StripeService {
    constructor(version, key, options, loader, window) {
        this.version = version;
        this.key = key;
        this.options = options;
        this.loader = loader;
        this.window = window;
        if (key) {
            this.stripe = new StripeInstance(this.version, this.loader, this.window, key, options);
        }
    }
    getStripeReference() {
        return this.loader.asStream().pipe(filter((status) => status.loaded === true), map(() => this.window.getNativeWindow().Stripe));
    }
    getInstance() {
        return this.stripe.getInstance();
    }
    setKey(key, options) {
        return this.changeKey(key, options);
    }
    changeKey(key, options) {
        this.stripe = new StripeInstance(this.version, this.loader, this.window, key, options);
        return this.stripe;
    }
    elements(options) {
        return this.stripe.elements(options);
    }
    redirectToCheckout(options) {
        return this.stripe.redirectToCheckout(options);
    }
    confirmPayment(options) {
        return this.stripe.confirmPayment(options);
    }
    confirmAcssDebitPayment(clientSecret, data, options) {
        return this.stripe.confirmAcssDebitPayment(clientSecret, data, options);
    }
    confirmAlipayPayment(clientSecret, data, options) {
        return this.stripe.confirmAlipayPayment(clientSecret, data, options);
    }
    confirmAuBecsDebitPayment(clientSecret, data) {
        return this.stripe.confirmAuBecsDebitPayment(clientSecret, data);
    }
    confirmBancontactPayment(clientSecret, data, options) {
        return this.stripe.confirmBancontactPayment(clientSecret, data, options);
    }
    confirmBoletoPayment(clientSecret, data, options) {
        return this.stripe.confirmBoletoPayment(clientSecret, data, options);
    }
    confirmCardPayment(clientSecret, data, options) {
        return this.stripe.confirmCardPayment(clientSecret, data, options);
    }
    confirmCustomerBalancePayment(clientSecret, data, options) {
        return this.stripe.confirmCustomerBalancePayment(clientSecret, data, options);
    }
    confirmEpsPayment(clientSecret, data, options) {
        return this.stripe.confirmEpsPayment(clientSecret, data, options);
    }
    confirmFpxPayment(clientSecret, data, options) {
        return this.stripe.confirmFpxPayment(clientSecret, data, options);
    }
    confirmGiropayPayment(clientSecret, data, options) {
        return this.stripe.confirmGiropayPayment(clientSecret, data, options);
    }
    confirmGrabPayPayment(clientSecret, data, options) {
        return this.stripe.confirmGrabPayPayment(clientSecret, data, options);
    }
    confirmIdealPayment(clientSecret, data, options) {
        return this.stripe.confirmIdealPayment(clientSecret, data, options);
    }
    confirmKlarnaPayment(clientSecret, data, options) {
        return this.stripe.confirmKlarnaPayment(clientSecret, data, options);
    }
    confirmOxxoPayment(clientSecret, data, options) {
        return this.stripe.confirmOxxoPayment(clientSecret, data, options);
    }
    confirmP24Payment(clientSecret, data, options) {
        return this.stripe.confirmP24Payment(clientSecret, data, options);
    }
    confirmPayNowPayment(clientSecret, data, options) {
        return this.stripe.confirmPayNowPayment(clientSecret, data, options);
    }
    confirmPayPalPayment(clientSecret, data) {
        return this.stripe.confirmPayPalPayment(clientSecret, data);
    }
    confirmPromptPayPayment(clientSecret, data, options) {
        return this.stripe.confirmPromptPayPayment(clientSecret, data, options);
    }
    confirmSepaDebitPayment(clientSecret, data) {
        return this.stripe.confirmSepaDebitPayment(clientSecret, data);
    }
    confirmSofortPayment(clientSecret, data) {
        return this.stripe.confirmSofortPayment(clientSecret, data);
    }
    confirmWechatPayPayment(clientSecret, data, options) {
        return this.stripe.confirmWechatPayPayment(clientSecret, data, options);
    }
    handleCardAction(clientSecret) {
        return this.stripe.handleCardAction(clientSecret);
    }
    verifyMicrodepositsForPayment(clientSecret, data) {
        return this.stripe.verifyMicrodepositsForPayment(clientSecret, data);
    }
    createPaymentMethod(paymentMethodData) {
        return this.stripe.createPaymentMethod(paymentMethodData);
    }
    retrievePaymentIntent(clientSecret) {
        return this.stripe.retrievePaymentIntent(clientSecret);
    }
    confirmSetup(options) {
        return this.stripe.confirmSetup(options);
    }
    confirmAcssDebitSetup(clientSecret, data, options) {
        return this.stripe.confirmAcssDebitSetup(clientSecret, data, options);
    }
    confirmAuBecsDebitSetup(clientSecret, data) {
        return this.stripe.confirmAuBecsDebitSetup(clientSecret, data);
    }
    confirmBacsDebitSetup(clientSecret, data) {
        return this.stripe.confirmBacsDebitSetup(clientSecret, data);
    }
    confirmBancontactSetup(clientSecret, data) {
        return this.stripe.confirmBancontactSetup(clientSecret, data);
    }
    confirmCardSetup(clientSecret, data, options) {
        return this.stripe.confirmCardSetup(clientSecret, data, options);
    }
    confirmIdealSetup(clientSecret, data) {
        return this.stripe.confirmIdealSetup(clientSecret, data);
    }
    confirmPayPalSetup(clientSecret, data) {
        return this.stripe.confirmPayPalSetup(clientSecret, data);
    }
    confirmSepaDebitSetup(clientSecret, data) {
        return this.stripe.confirmSepaDebitSetup(clientSecret, data);
    }
    confirmSofortSetup(clientSecret, data) {
        return this.stripe.confirmSofortSetup(clientSecret, data);
    }
    confirmAffirmPayment(clientSecret, data, options) {
        return this.stripe.confirmAffirmPayment(clientSecret, data, options);
    }
    confirmAfterpayClearpayPayment(clientSecret, data, options) {
        return this.stripe.confirmAfterpayClearpayPayment(clientSecret, data, options);
    }
    verifyMicrodepositsForSetup(clientSecret, data) {
        return this.stripe.verifyMicrodepositsForSetup(clientSecret, data);
    }
    retrieveSetupIntent(clientSecret) {
        return this.stripe.retrieveSetupIntent(clientSecret);
    }
    paymentRequest(options) {
        return this.stripe.paymentRequest(options);
    }
    createToken(tokenType, data) {
        return this.stripe.createToken(tokenType, data);
    }
    createSource(a, b) {
        return this.stripe.createSource(a, b);
    }
    retrieveSource(source) {
        return this.stripe.retrieveSource(source);
    }
    verifyIdentity(clientSecret) {
        return this.stripe.verifyIdentity(clientSecret);
    }
    /**
     * @deprecated
     */
    handleCardPayment(clientSecret, element, data) {
        return this.stripe.handleCardPayment(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    confirmPaymentIntent(clientSecret, element, data) {
        return this.stripe.confirmPaymentIntent(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    handleCardSetup(clientSecret, element, data) {
        return this.stripe.handleCardSetup(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    confirmSetupIntent(clientSecret, element, data) {
        return this.stripe.confirmSetupIntent(clientSecret, element, data);
    }
    /**
     * @deprecated
     */
    handleFpxPayment(clientSecret, element, data) {
        return this.stripe.handleFpxPayment(clientSecret, element, data);
    }
}
StripeService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: StripeService, deps: [{ token: NGX_STRIPE_VERSION }, { token: STRIPE_PUBLISHABLE_KEY }, { token: STRIPE_OPTIONS }, { token: i1.LazyStripeAPILoader }, { token: i2.WindowRef }], target: i0.ɵɵFactoryTarget.Injectable });
StripeService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: StripeService });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.0", ngImport: i0, type: StripeService, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Inject,
                    args: [NGX_STRIPE_VERSION]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [STRIPE_PUBLISHABLE_KEY]
                }] }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [STRIPE_OPTIONS]
                }] }, { type: i1.LazyStripeAPILoader }, { type: i2.WindowRef }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyaXBlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc3RyaXBlL3NyYy9saWIvc2VydmljZXMvc3RyaXBlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbkQsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQXdGN0MsT0FBTyxFQUNMLHNCQUFzQixFQUN0QixjQUFjLEVBQ2Qsa0JBQWtCLEVBQ25CLE1BQU0sb0NBQW9DLENBQUM7QUFTNUMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHlCQUF5QixDQUFDOzs7O0FBR3pELE1BQU0sT0FBTyxhQUFhO0lBR3hCLFlBQ3FDLE9BQWUsRUFDWCxHQUFXLEVBQ25CLE9BQWlDLEVBQ3pELE1BQTJCLEVBQzNCLE1BQWlCO1FBSlcsWUFBTyxHQUFQLE9BQU8sQ0FBUTtRQUNYLFFBQUcsR0FBSCxHQUFHLENBQVE7UUFDbkIsWUFBTyxHQUFQLE9BQU8sQ0FBMEI7UUFDekQsV0FBTSxHQUFOLE1BQU0sQ0FBcUI7UUFDM0IsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUV4QixJQUFJLEdBQUcsRUFBRTtZQUNQLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ3hGO0lBQ0gsQ0FBQztJQUVELGtCQUFrQjtRQUNoQixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsSUFBSSxDQUNoQyxNQUFNLENBQUMsQ0FBQyxNQUFpQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxFQUNyRSxH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QUFDO0lBQ3ZFLENBQUM7SUFFRDs7T0FFRztJQUNILGVBQWUsQ0FDYixZQUFvQixFQUNwQixPQUFRLEVBQ1IsSUFBSztRQUtMLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsWUFBWSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBRUQ7O09BRUc7SUFDSCxrQkFBa0IsQ0FDaEIsWUFBb0IsRUFDcEIsT0FBUSxFQUNSLElBQUs7UUFLTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsWUFBWSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNyRSxDQUFDO0lBRUQ7O09BRUc7SUFDSCxnQkFBZ0IsQ0FDZCxZQUFvQixFQUNwQixPQUFRLEVBQ1IsSUFBSztRQUtMLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25FLENBQUM7OzBHQTFsQlUsYUFBYSxrQkFJZCxrQkFBa0IsYUFDbEIsc0JBQXNCLGFBQ3RCLGNBQWM7OEdBTmIsYUFBYTsyRkFBYixhQUFhO2tCQUR6QixVQUFVOzswQkFLTixNQUFNOzJCQUFDLGtCQUFrQjs7MEJBQ3pCLE1BQU07MkJBQUMsc0JBQXNCOzswQkFDN0IsTUFBTTsyQkFBQyxjQUFjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHtcbiAgQ29uZmlybUFjc3NEZWJpdFBheW1lbnREYXRhLFxuICBDb25maXJtQWNzc0RlYml0UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudERhdGEsXG4gIENvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1BbGlwYXlQYXltZW50RGF0YSxcbiAgQ29uZmlybUFsaXBheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtQXVCZWNzRGViaXRQYXltZW50RGF0YSxcbiAgQ29uZmlybUF1QmVjc0RlYml0U2V0dXBEYXRhLFxuICBDb25maXJtQmFuY29udGFjdFBheW1lbnREYXRhLFxuICBDb25maXJtQmFuY29udGFjdFBheW1lbnRPcHRpb25zLFxuICBDb25maXJtQm9sZXRvUGF5bWVudERhdGEsXG4gIENvbmZpcm1Cb2xldG9QYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUNhcmRQYXltZW50RGF0YSxcbiAgQ29uZmlybUNhcmRQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUVwc1BheW1lbnREYXRhLFxuICBDb25maXJtRXBzUGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1GcHhQYXltZW50RGF0YSxcbiAgQ29uZmlybUZweFBheW1lbnRPcHRpb25zLFxuICBDb25maXJtR2lyb3BheVBheW1lbnREYXRhLFxuICBDb25maXJtR2lyb3BheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtR3JhYlBheVBheW1lbnREYXRhLFxuICBDb25maXJtR3JhYlBheVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtSWRlYWxQYXltZW50RGF0YSxcbiAgQ29uZmlybUlkZWFsUGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1LbGFybmFQYXltZW50RGF0YSxcbiAgQ29uZmlybUtsYXJuYVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtT3h4b1BheW1lbnREYXRhLFxuICBDb25maXJtT3h4b1BheW1lbnRPcHRpb25zLFxuICBDb25maXJtUDI0UGF5bWVudERhdGEsXG4gIENvbmZpcm1QMjRQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybUNhcmRTZXR1cERhdGEsXG4gIENvbmZpcm1DYXJkU2V0dXBPcHRpb25zLFxuICBDb25maXJtU2VwYURlYml0UGF5bWVudERhdGEsXG4gIENvbmZpcm1Tb2ZvcnRQYXltZW50RGF0YSxcbiAgQ29uZmlybVdlY2hhdFBheVBheW1lbnREYXRhLFxuICBDb25maXJtV2VjaGF0UGF5UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1TZXBhRGViaXRTZXR1cERhdGEsXG4gIENyZWF0ZVBheW1lbnRNZXRob2REYXRhLFxuICBWZXJpZnlNaWNyb2RlcG9zaXRzRm9yUGF5bWVudERhdGEsXG4gIENvbmZpcm1BY3NzRGViaXRTZXR1cERhdGEsXG4gIENvbmZpcm1BY3NzRGViaXRTZXR1cE9wdGlvbnMsXG4gIENyZWF0ZVNvdXJjZURhdGEsXG4gIENyZWF0ZVRva2VuSWJhbkRhdGEsXG4gIENyZWF0ZVRva2VuQ2FyZERhdGEsXG4gIENyZWF0ZVRva2VuUGlpRGF0YSxcbiAgQ3JlYXRlVG9rZW5CYW5rQWNjb3VudERhdGEsXG4gIFBheW1lbnRJbnRlbnQsXG4gIFBheW1lbnRNZXRob2QsXG4gIFBheW1lbnRSZXF1ZXN0LFxuICBQYXltZW50UmVxdWVzdE9wdGlvbnMsXG4gIFJlZGlyZWN0VG9DaGVja291dE9wdGlvbnMsXG4gIFJldHJpZXZlU291cmNlUGFyYW0sXG4gIFNldHVwSW50ZW50LFxuICBTdHJpcGUsXG4gIFN0cmlwZUNhcmRFbGVtZW50LFxuICBTdHJpcGVDYXJkTnVtYmVyRWxlbWVudCxcbiAgU3RyaXBlQ2FyZEN2Y0VsZW1lbnQsXG4gIFN0cmlwZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgU3RyaXBlRWxlbWVudHMsXG4gIFN0cmlwZUVsZW1lbnRzT3B0aW9ucyxcbiAgU3RyaXBlRWxlbWVudCxcbiAgU3RyaXBlRXJyb3IsXG4gIFN0cmlwZUliYW5FbGVtZW50LFxuICBTb3VyY2UsXG4gIFRva2VuLFxuICBUb2tlbkNyZWF0ZVBhcmFtcyxcbiAgQ29uZmlybUJhY3NEZWJpdFNldHVwRGF0YSxcbiAgQ29uZmlybUJhbmNvbnRhY3RTZXR1cERhdGEsXG4gIENvbmZpcm1JZGVhbFNldHVwRGF0YSxcbiAgQ29uZmlybVNvZm9ydFNldHVwRGF0YSxcbiAgVmVyaWZ5TWljcm9kZXBvc2l0c0ZvclNldHVwRGF0YSxcbiAgVmVyaWZpY2F0aW9uU2Vzc2lvblJlc3VsdCxcbiAgQ29uZmlybVBheVBhbFBheW1lbnREYXRhLFxuICBDb25maXJtUGF5UGFsU2V0dXBEYXRhLFxuICBDb25maXJtUGF5bWVudERhdGEsXG4gIENvbmZpcm1DdXN0b21lckJhbGFuY2VQYXltZW50RGF0YSxcbiAgQ29uZmlybUN1c3RvbWVyQmFsYW5jZVBheW1lbnRPcHRpb25zLFxuICBDb25maXJtUGF5Tm93UGF5bWVudERhdGEsXG4gIENvbmZpcm1QYXlOb3dQYXltZW50T3B0aW9ucyxcbiAgQ29uZmlybVByb21wdFBheVBheW1lbnREYXRhLFxuICBDb25maXJtUHJvbXB0UGF5UGF5bWVudE9wdGlvbnMsXG4gIENvbmZpcm1BZmZpcm1QYXltZW50RGF0YSxcbiAgQ29uZmlybUFmZmlybVBheW1lbnRPcHRpb25zLFxufSBmcm9tICdAc3RyaXBlL3N0cmlwZS1qcyc7XG5cbmltcG9ydCB7XG4gIFNUUklQRV9QVUJMSVNIQUJMRV9LRVksXG4gIFNUUklQRV9PUFRJT05TLFxuICBOR1hfU1RSSVBFX1ZFUlNJT05cbn0gZnJvbSAnLi4vaW50ZXJmYWNlcy9uZ3gtc3RyaXBlLmludGVyZmFjZSc7XG5pbXBvcnQgeyBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9zdHJpcGUtaW5zdGFuY2UuaW50ZXJmYWNlJztcblxuaW1wb3J0IHsgV2luZG93UmVmIH0gZnJvbSAnLi93aW5kb3ctcmVmLnNlcnZpY2UnO1xuaW1wb3J0IHtcbiAgTGF6eVN0cmlwZUFQSUxvYWRlcixcbiAgTGF6eVN0cmlwZUFQSUxvYWRlclN0YXR1c1xufSBmcm9tICcuL2FwaS1sb2FkZXIuc2VydmljZSc7XG5cbmltcG9ydCB7IFN0cmlwZUluc3RhbmNlIH0gZnJvbSAnLi9zdHJpcGUtaW5zdGFuY2UuY2xhc3MnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgU3RyaXBlU2VydmljZSBpbXBsZW1lbnRzIFN0cmlwZVNlcnZpY2VJbnRlcmZhY2Uge1xuICBzdHJpcGUhOiBTdHJpcGVJbnN0YW5jZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0KE5HWF9TVFJJUEVfVkVSU0lPTikgcHVibGljIHZlcnNpb246IHN0cmluZyxcbiAgICBASW5qZWN0KFNUUklQRV9QVUJMSVNIQUJMRV9LRVkpIHB1YmxpYyBrZXk6IHN0cmluZyxcbiAgICBASW5qZWN0KFNUUklQRV9PUFRJT05TKSBwdWJsaWMgb3B0aW9uczogU3RyaXBlQ29uc3RydWN0b3JPcHRpb25zLFxuICAgIHB1YmxpYyBsb2FkZXI6IExhenlTdHJpcGVBUElMb2FkZXIsXG4gICAgcHVibGljIHdpbmRvdzogV2luZG93UmVmXG4gICkge1xuICAgIGlmIChrZXkpIHtcbiAgICAgIHRoaXMuc3RyaXBlID0gbmV3IFN0cmlwZUluc3RhbmNlKHRoaXMudmVyc2lvbiwgdGhpcy5sb2FkZXIsIHRoaXMud2luZG93LCBrZXksIG9wdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIGdldFN0cmlwZVJlZmVyZW5jZSgpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmxvYWRlci5hc1N0cmVhbSgpLnBpcGUoXG4gICAgICBmaWx0ZXIoKHN0YXR1czogTGF6eVN0cmlwZUFQSUxvYWRlclN0YXR1cykgPT4gc3RhdHVzLmxvYWRlZCA9PT0gdHJ1ZSksXG4gICAgICBtYXAoKCkgPT4gKHRoaXMud2luZG93LmdldE5hdGl2ZVdpbmRvdygpIGFzIGFueSkuU3RyaXBlKVxuICAgICk7XG4gIH1cblxuICBnZXRJbnN0YW5jZSgpOiBTdHJpcGUgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5nZXRJbnN0YW5jZSgpO1xuICB9XG5cbiAgc2V0S2V5KGtleTogc3RyaW5nLCBvcHRpb25zPzogU3RyaXBlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhbmdlS2V5KGtleSwgb3B0aW9ucyk7XG4gIH1cblxuICBjaGFuZ2VLZXkoa2V5OiBzdHJpbmcsIG9wdGlvbnM/OiBTdHJpcGVDb25zdHJ1Y3Rvck9wdGlvbnMpIHtcbiAgICB0aGlzLnN0cmlwZSA9IG5ldyBTdHJpcGVJbnN0YW5jZSh0aGlzLnZlcnNpb24sIHRoaXMubG9hZGVyLCB0aGlzLndpbmRvdywga2V5LCBvcHRpb25zKTtcblxuICAgIHJldHVybiB0aGlzLnN0cmlwZTtcbiAgfVxuXG4gIGVsZW1lbnRzKG9wdGlvbnM/OiBTdHJpcGVFbGVtZW50c09wdGlvbnMpOiBPYnNlcnZhYmxlPFN0cmlwZUVsZW1lbnRzPiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmVsZW1lbnRzKG9wdGlvbnMpO1xuICB9XG5cbiAgcmVkaXJlY3RUb0NoZWNrb3V0KFxuICAgIG9wdGlvbnM/OiBSZWRpcmVjdFRvQ2hlY2tvdXRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8bmV2ZXIgfCB7IGVycm9yOiBTdHJpcGVFcnJvciB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJlZGlyZWN0VG9DaGVja291dChvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1QYXltZW50KG9wdGlvbnM6IHtcbiAgICBlbGVtZW50czogU3RyaXBlRWxlbWVudHM7XG4gICAgY29uZmlybVBhcmFtcz86IFBhcnRpYWw8Q29uZmlybVBheW1lbnREYXRhPjtcbiAgICByZWRpcmVjdDogJ2lmX3JlcXVpcmVkJztcbiAgfSk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+O1xuICBjb25maXJtUGF5bWVudChvcHRpb25zOiB7XG4gICAgZWxlbWVudHM6IFN0cmlwZUVsZW1lbnRzO1xuICAgIGNvbmZpcm1QYXJhbXM6IENvbmZpcm1QYXltZW50RGF0YTtcbiAgICByZWRpcmVjdD86ICdhbHdheXMnO1xuICB9KTogT2JzZXJ2YWJsZTxuZXZlciB8IHtlcnJvcjogU3RyaXBlRXJyb3J9PjtcbiAgY29uZmlybVBheW1lbnQob3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUGF5bWVudChvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1BY3NzRGViaXRQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQWNzc0RlYml0UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1BY3NzRGViaXRQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BY3NzRGViaXRQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQWxpcGF5UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUFsaXBheVBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtQWxpcGF5UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQWxpcGF5UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUF1QmVjc0RlYml0UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUF1QmVjc0RlYml0UGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQXVCZWNzRGViaXRQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtQmFuY29udGFjdFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1CYW5jb250YWN0UGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1CYW5jb250YWN0UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQmFuY29udGFjdFBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1Cb2xldG9QYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQm9sZXRvUGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1Cb2xldG9QYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Cb2xldG9QYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQ2FyZFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1DYXJkUGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1DYXJkUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQ2FyZFBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1DdXN0b21lckJhbGFuY2VQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQ3VzdG9tZXJCYWxhbmNlUGF5bWVudERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1DdXN0b21lckJhbGFuY2VQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1DdXN0b21lckJhbGFuY2VQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtRXBzUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUVwc1BheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtRXBzUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtRXBzUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUZweFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1GcHhQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUZweFBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUZweFBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1HaXJvcGF5UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUdpcm9wYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUdpcm9wYXlQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1HaXJvcGF5UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUdyYWJQYXlQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtR3JhYlBheVBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtR3JhYlBheVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUdyYWJQYXlQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtSWRlYWxQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtSWRlYWxQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUlkZWFsUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtSWRlYWxQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtS2xhcm5hUGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUtsYXJuYVBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtS2xhcm5hUGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtS2xhcm5hUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybU94eG9QYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtT3h4b1BheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtT3h4b1BheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybU94eG9QYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtUDI0UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVAyNFBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtUDI0UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUDI0UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybVBheU5vd1BheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1QYXlOb3dQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybVBheU5vd1BheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVBheU5vd1BheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1QYXlQYWxQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtUGF5UGFsUGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUGF5UGFsUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVByb21wdFBheVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1Qcm9tcHRQYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybVByb21wdFBheVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVByb21wdFBheVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1TZXBhRGViaXRQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtU2VwYURlYml0UGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU2VwYURlYml0UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVNvZm9ydFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1Tb2ZvcnRQYXltZW50RGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Tb2ZvcnRQYXltZW50KGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtV2VjaGF0UGF5UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVdlY2hhdFBheVBheW1lbnREYXRhLFxuICAgIG9wdGlvbnM/OiBDb25maXJtV2VjaGF0UGF5UGF5bWVudE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtV2VjaGF0UGF5UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgaGFuZGxlQ2FyZEFjdGlvbihcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZ1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmhhbmRsZUNhcmRBY3Rpb24oY2xpZW50U2VjcmV0KTtcbiAgfVxuXG4gIHZlcmlmeU1pY3JvZGVwb3NpdHNGb3JQYXltZW50KFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBWZXJpZnlNaWNyb2RlcG9zaXRzRm9yUGF5bWVudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS52ZXJpZnlNaWNyb2RlcG9zaXRzRm9yUGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY3JlYXRlUGF5bWVudE1ldGhvZChcbiAgICBwYXltZW50TWV0aG9kRGF0YTogQ3JlYXRlUGF5bWVudE1ldGhvZERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudE1ldGhvZD86IFBheW1lbnRNZXRob2Q7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jcmVhdGVQYXltZW50TWV0aG9kKHBheW1lbnRNZXRob2REYXRhKTtcbiAgfVxuXG4gIHJldHJpZXZlUGF5bWVudEludGVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZ1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJldHJpZXZlUGF5bWVudEludGVudChjbGllbnRTZWNyZXQpO1xuICB9XG5cbiAgY29uZmlybVNldHVwKG9wdGlvbnM6IHtcbiAgICBlbGVtZW50czogU3RyaXBlRWxlbWVudHM7XG4gICAgY29uZmlybVBhcmFtcz86IFBhcnRpYWw8Q29uZmlybVBheW1lbnREYXRhPjtcbiAgICByZWRpcmVjdDogJ2lmX3JlcXVpcmVkJztcbiAgfSk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT47XG4gIGNvbmZpcm1TZXR1cChvcHRpb25zOiB7XG4gICAgZWxlbWVudHM6IFN0cmlwZUVsZW1lbnRzO1xuICAgIGNvbmZpcm1QYXJhbXM6IENvbmZpcm1QYXltZW50RGF0YTtcbiAgICByZWRpcmVjdD86ICdhbHdheXMnO1xuICB9KTogT2JzZXJ2YWJsZTxuZXZlciB8IHsgZXJyb3I6IFN0cmlwZUVycm9yIH0+O1xuICBjb25maXJtU2V0dXAob3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtU2V0dXAob3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtQWNzc0RlYml0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BY3NzRGViaXRTZXR1cERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1BY3NzRGViaXRTZXR1cE9wdGlvbnNcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BY3NzRGViaXRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgY29uZmlybUF1QmVjc0RlYml0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BdUJlY3NEZWJpdFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUF1QmVjc0RlYml0U2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbmZpcm1CYWNzRGViaXRTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUJhY3NEZWJpdFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUJhY3NEZWJpdFNldHVwKGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtQmFuY29udGFjdFNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtQmFuY29udGFjdFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUJhbmNvbnRhY3RTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybUNhcmRTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUNhcmRTZXR1cERhdGEsXG4gICAgb3B0aW9ucz86IENvbmZpcm1DYXJkU2V0dXBPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtQ2FyZFNldHVwKGNsaWVudFNlY3JldCwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cblxuICBjb25maXJtSWRlYWxTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUlkZWFsU2V0dXBEYXRhXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtSWRlYWxTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybVBheVBhbFNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBDb25maXJtUGF5UGFsU2V0dXBEYXRhXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jb25maXJtUGF5UGFsU2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIGNvbmZpcm1TZXBhRGViaXRTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybVNlcGFEZWJpdFNldHVwRGF0YVxuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVNlcGFEZWJpdFNldHVwKGNsaWVudFNlY3JldCwgZGF0YSk7XG4gIH1cblxuICBjb25maXJtU29mb3J0U2V0dXAoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1Tb2ZvcnRTZXR1cERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1Tb2ZvcnRTZXR1cChjbGllbnRTZWNyZXQsIGRhdGEpO1xuICB9XG5cbiAgY29uZmlybUFmZmlybVBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZGF0YT86IENvbmZpcm1BZmZpcm1QYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUFmZmlybVBheW1lbnRPcHRpb25zXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHBheW1lbnRJbnRlbnQ/OiBQYXltZW50SW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybUFmZmlybVBheW1lbnQoY2xpZW50U2VjcmV0LCBkYXRhLCBvcHRpb25zKTtcbiAgfVxuXG4gIGNvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBkYXRhPzogQ29uZmlybUFmdGVycGF5Q2xlYXJwYXlQYXltZW50RGF0YSxcbiAgICBvcHRpb25zPzogQ29uZmlybUFmdGVycGF5Q2xlYXJwYXlQYXltZW50T3B0aW9uc1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1BZnRlcnBheUNsZWFycGF5UGF5bWVudChjbGllbnRTZWNyZXQsIGRhdGEsIG9wdGlvbnMpO1xuICB9XG5cbiAgdmVyaWZ5TWljcm9kZXBvc2l0c0ZvclNldHVwKFxuICAgIGNsaWVudFNlY3JldDogc3RyaW5nLFxuICAgIGRhdGE/OiBWZXJpZnlNaWNyb2RlcG9zaXRzRm9yU2V0dXBEYXRhXG4gICk6IE9ic2VydmFibGU8e1xuICAgIHNldHVwSW50ZW50PzogU2V0dXBJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS52ZXJpZnlNaWNyb2RlcG9zaXRzRm9yU2V0dXAoY2xpZW50U2VjcmV0LCBkYXRhKTtcbiAgfVxuXG4gIHJldHJpZXZlU2V0dXBJbnRlbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmdcbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLnJldHJpZXZlU2V0dXBJbnRlbnQoY2xpZW50U2VjcmV0KTtcbiAgfVxuXG4gIHBheW1lbnRSZXF1ZXN0KG9wdGlvbnM6IFBheW1lbnRSZXF1ZXN0T3B0aW9ucyk6IFBheW1lbnRSZXF1ZXN0IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUucGF5bWVudFJlcXVlc3Qob3B0aW9ucyk7XG4gIH1cblxuICBjcmVhdGVUb2tlbihcbiAgICB0b2tlblR5cGU6IFN0cmlwZUliYW5FbGVtZW50LFxuICAgIGRhdGE6IENyZWF0ZVRva2VuSWJhbkRhdGFcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKFxuICAgIHRva2VuVHlwZTogU3RyaXBlQ2FyZEVsZW1lbnQgfCBTdHJpcGVDYXJkTnVtYmVyRWxlbWVudCxcbiAgICBkYXRhPzogQ3JlYXRlVG9rZW5DYXJkRGF0YVxuICApOiBPYnNlcnZhYmxlPHsgdG9rZW4/OiBUb2tlbjsgZXJyb3I/OiBTdHJpcGVFcnJvciB9PjtcbiAgY3JlYXRlVG9rZW4oXG4gICAgdG9rZW5UeXBlOiAncGlpJyxcbiAgICBkYXRhOiBDcmVhdGVUb2tlblBpaURhdGFcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKFxuICAgIHRva2VuVHlwZTogJ2JhbmtfYWNjb3VudCcsXG4gICAgZGF0YTogQ3JlYXRlVG9rZW5CYW5rQWNjb3VudERhdGFcbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKFxuICAgIHRva2VuVHlwZTogJ2N2Y191cGRhdGUnLFxuICAgIGVsZW1lbnQ/OiBTdHJpcGVDYXJkQ3ZjRWxlbWVudFxuICApOiBPYnNlcnZhYmxlPHsgdG9rZW4/OiBUb2tlbjsgZXJyb3I/OiBTdHJpcGVFcnJvciB9PjtcbiAgY3JlYXRlVG9rZW4oXG4gICAgdG9rZW5UeXBlOiAnYWNjb3VudCcsXG4gICAgZGF0YTogVG9rZW5DcmVhdGVQYXJhbXMuQWNjb3VudFxuICApOiBPYnNlcnZhYmxlPHsgdG9rZW4/OiBUb2tlbjsgZXJyb3I/OiBTdHJpcGVFcnJvciB9PjtcbiAgY3JlYXRlVG9rZW4oXG4gICAgdG9rZW5UeXBlOiAncGVyc29uJyxcbiAgICBkYXRhOiBUb2tlbkNyZWF0ZVBhcmFtcy5QZXJzb25cbiAgKTogT2JzZXJ2YWJsZTx7IHRva2VuPzogVG9rZW47IGVycm9yPzogU3RyaXBlRXJyb3IgfT47XG4gIGNyZWF0ZVRva2VuKHRva2VuVHlwZSwgZGF0YSkge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5jcmVhdGVUb2tlbih0b2tlblR5cGUsIGRhdGEpO1xuICB9XG5cbiAgY3JlYXRlU291cmNlKFxuICAgIGVsZW1lbnQ6IFN0cmlwZUVsZW1lbnQsXG4gICAgc291cmNlRGF0YTogQ3JlYXRlU291cmNlRGF0YVxuICApOiBPYnNlcnZhYmxlPHsgc291cmNlPzogU291cmNlOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVTb3VyY2UoXG4gICAgc291cmNlRGF0YTogQ3JlYXRlU291cmNlRGF0YVxuICApOiBPYnNlcnZhYmxlPHsgc291cmNlPzogU291cmNlOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+O1xuICBjcmVhdGVTb3VyY2UoYSwgYj8pOiBPYnNlcnZhYmxlPHsgc291cmNlPzogU291cmNlOyBlcnJvcj86IFN0cmlwZUVycm9yIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY3JlYXRlU291cmNlKGEsIGIpO1xuICB9XG5cbiAgcmV0cmlldmVTb3VyY2UoXG4gICAgc291cmNlOiBSZXRyaWV2ZVNvdXJjZVBhcmFtXG4gICk6IE9ic2VydmFibGU8eyBzb3VyY2U/OiBTb3VyY2U7IGVycm9yPzogU3RyaXBlRXJyb3IgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5yZXRyaWV2ZVNvdXJjZShzb3VyY2UpO1xuICB9XG5cbiAgdmVyaWZ5SWRlbnRpdHkoY2xpZW50U2VjcmV0OiBzdHJpbmcpOiBPYnNlcnZhYmxlPFZlcmlmaWNhdGlvblNlc3Npb25SZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUudmVyaWZ5SWRlbnRpdHkoY2xpZW50U2VjcmV0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZFxuICAgKi9cbiAgaGFuZGxlQ2FyZFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZWxlbWVudD8sXG4gICAgZGF0YT9cbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgcGF5bWVudEludGVudD86IFBheW1lbnRJbnRlbnQ7XG4gICAgZXJyb3I/OiBTdHJpcGVFcnJvcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLnN0cmlwZS5oYW5kbGVDYXJkUGF5bWVudChjbGllbnRTZWNyZXQsIGVsZW1lbnQsIGRhdGEpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICBjb25maXJtUGF5bWVudEludGVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBlbGVtZW50PyxcbiAgICBkYXRhP1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBwYXltZW50SW50ZW50PzogUGF5bWVudEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmNvbmZpcm1QYXltZW50SW50ZW50KGNsaWVudFNlY3JldCwgZWxlbWVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIGhhbmRsZUNhcmRTZXR1cChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBlbGVtZW50PyxcbiAgICBkYXRhP1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuaGFuZGxlQ2FyZFNldHVwKGNsaWVudFNlY3JldCwgZWxlbWVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIGNvbmZpcm1TZXR1cEludGVudChcbiAgICBjbGllbnRTZWNyZXQ6IHN0cmluZyxcbiAgICBlbGVtZW50PyxcbiAgICBkYXRhP1xuICApOiBPYnNlcnZhYmxlPHtcbiAgICBzZXR1cEludGVudD86IFNldHVwSW50ZW50O1xuICAgIGVycm9yPzogU3RyaXBlRXJyb3I7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5zdHJpcGUuY29uZmlybVNldHVwSW50ZW50KGNsaWVudFNlY3JldCwgZWxlbWVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICovXG4gIGhhbmRsZUZweFBheW1lbnQoXG4gICAgY2xpZW50U2VjcmV0OiBzdHJpbmcsXG4gICAgZWxlbWVudD8sXG4gICAgZGF0YT9cbiAgKTogT2JzZXJ2YWJsZTx7XG4gICAgc2V0dXBJbnRlbnQ/OiBTZXR1cEludGVudDtcbiAgICBlcnJvcj86IFN0cmlwZUVycm9yO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaXBlLmhhbmRsZUZweFBheW1lbnQoY2xpZW50U2VjcmV0LCBlbGVtZW50LCBkYXRhKTtcbiAgfVxufVxuIl19